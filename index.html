<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>CSVファイル表示</title>
</head>
<body>
 <h1>CSVファイルの内容</h1>
 <div class="event">
 <p>曜日(イベント)を選択</p>
 <div class="event-radio">
  <input type="radio" id="radio1" name="radioButton" value="1">
  <label for="radio1">水曜・日曜(等倍)</label>
 </div>
 <div class="event-radio">
  <input type="radio" id="radio2" name="radioButton" value="1.5">
  <label for="radio2">月曜・木曜・金曜(1.5倍)</label>
 </div>
 <div class="event-radio">
  <input type="radio" id="radio3" name="radioButton" value="2.5">
  <label for="radio3">火曜・土曜(2.5倍)</label>
 </div>
 <div class="event-radio">
  <input type="radio" id="radio4" name="radioButton" value="4">
  <label for="radio4">4倍イベント</label>
 </div>
 </div>

 <div class="multi">
 <p class="subject">倍率指定</p>
 <div class="multi-check">
  <input type="checkbox" id="monthly">
  <label for="monthly">マンスリーパス効果(+15%)</label>
 </div>
 <div class="multi-check">
  <input type="checkbox" id="passive">
  <label for="passive">[ごめんねFingers crossed]梅澤美波<br>[まあいいか？]秋元真夏 どちらかを所持(+30%)</label>
 </div>
 <div class="multi-check">
  <input type="text" class="textbox" id="memo" inputmode="decimal">
  <label for="memo">％：メンバーノギメモ効果</label>
 </div>
 <div class="range-slider">
  <label for="rangeSlider" class="range-text">上振れ補正</label>	
  <input type="range" id="rangeSlider" min="0" max="5" step="0.5" value="0" oninput="updateRangeValue()">
	 <span class="range-text">+</span>
  <span class="range-label" id="rangeLabel">0</span>
	 <span class="range-text">[%]</span>
 </div>
 </div>
  
 <div class="range">
 <input type="text" class="textbox" id="start" inputmode="decimal">
 <label for="start">開始行</label>
 <input type="text" class="textbox" id="end" inputmode="decimal">
 <label for="end">終了行</label>
 </div>
  
 <div class="switch">
 <input type="checkbox" id="non120">
 <label for="non120">切り替え</label>
 </div>
  
 <button id="btn-csv">開く</button>
  
 <table id="csv-table"></table>
  
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.5/jquery.csv.min.js"></script>
  
<script>
$(document).ready(function() {
  // 初期化
  $("#csv-table").empty();

  // ボタンクリック時の処理
  $("#btn-csv").click(function() {
    // ファイル名
    var filename = $("#non120").is(":checked") ? "xp2.csv" : "xp1.csv";
    // 開始行
    var start = parseInt($("#start").val()) + 1;
    // 終了行
    var end = parseInt($("#end").val()) + 1;

    // CSVファイル読み込み
    $.ajax({
      url: filename,
      dataType: "text",
      success: function(data) {
        // CSVデータのパース
        var csvData = $.csv.toObjects(data);

        // 表示範囲の調整
        if (start > 1) {
          csvData = csvData.slice(start - 1);
        }
        if (end > 1) {
          csvData = csvData.slice(0, end - 1);
        }

        // テーブルへの表示
        $("#csv-table").empty().append(
          "<tr>" +
            csvData[0]
              .map(function(item) {
                return "<th>" + item + "</th>";
              })
              .join("") +
          "</tr>"
        );
        for (var i = 0; i < csvData.length; i++) {
          $("#csv-table").append(
            "<tr>" +
              csvData[i]
                .map(function(item) {
                  return "<td>" + item + "</td>";
                })
                .join("") +
            "</tr>"
          );
        }
      }
    });
  });
});
</script>
	
 <style>
	 
 </style>
</body>
</html>
